<div class="row">
  <div class="col-md-2">
    <img src="images/letterhead.png" />
  </div>
  <div class="col-md-10">
    <h4>Student-Athlete Registration Form<br />Step 2 of 2</h4>
  </div>
</div>

<br />

<form role="form" method="post">

  <div class="panel panel-default">
    <div class="panel-heading">Student Information</div>
    <div class="panel-body">
      
      <!-- new row -->
      <div class="row">
        <div class="col-md-6">
         <div class="form-group">
            <label for="studentNumber">Student #</label>
            <input id="reg-student-number" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>
        <div class="col-md-6">
         <div class="form-group">
            <label for="studentNumber">Email</label>
            <input id="reg-email" type="email" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>
      </div>

      <!-- new row -->
      <div class="row">
        <div class="col-md-5">
          <div class="form-group">
            <label for="studentNumber">First Name</label>
            <input id="reg-first-name" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>
        <div class="col-md-5">
          <div class="form-group">
            <label for="studentNumber">Last Name</label>
            <input id="reg-last-name" type="email" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>
        <div class="col-md-2">
          <div class="form-group">
            <label for="studentNumber">Initial(s)</label>
            <input id="reg-initials" type="email" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>
      </div>

      <!-- new row -->
      <div class="row">

        <div class="col-md-3">
          <div class="form-group">
            <label for="studentNumber">Gender</label>
            <select id="reg-gender" class="form-control">
              <option></option>
              <option>Male</option>
              <option>Female</option>
            </select>
          </div>
        </div>

        <div class="col-md-3">
          <div class="form-group">
            <label for="monthOfBirth">Date of Birth</label>
            <input id="reg-date-of-birth" type="input" class="form-control" id="monthOfBirth" placeholder="MM/DD/YYYY">
          </div>
        </div>

        <div class="col-md-3">
          <div class="form-group">
            <label for="studentNumber">Height</label>
            <input id="reg-height" type="email" class="form-control" id="studentNumber" placeholder="ex. 5&#39;8&#34;">
          </div>
        </div>

        <div class="col-md-3">
          <div class="form-group">
            <label for="studentNumber">Weight (lbs.)</label>
            <input id="reg-weight" type="email" class="form-control" id="studentNumber" placeholder="ex. 160">
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">Current Address</div>
    <div class="panel-body">

      <!-- new row -->
      <div class="row">
        <div class="col-md-6">
         <div class="form-group">
            <label for="studentNumber">Street</label>
            <input id="reg-current-street" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>

        <div class="col-md-3">
          <div class="form-group">
            <label for="studentNumber">City</label>
            <input id="reg-current-city" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>

        <div class="col-md-3">
          <div class="form-group">
            <label for="studentNumber">Province</label>
            <input id="reg-current-province" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>
      </div>

      <!-- new row -->
      <div class="row">
        <div class="col-md-6">
          <div class="form-group">
            <label for="studentNumber">Phone</label>
            <input id="reg-current-phone" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>

        <div class="col-md-3">
          <div class="form-group">
            <label for="studentNumber">Postal Code</label>
            <input id="reg-current-postal" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>

        <div class="col-md-3">
          <div class="form-group">
            <label for="studentNumber">Country</label>
            <input id="reg-current-country" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">Permanent Address</div>
    <div class="panel-body">

      <!-- new row -->
      <div class="row">
        <div class="col-md-6">
         <div class="form-group">
            <label for="studentNumber">Street</label>
            <input id="reg-permanent-street" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>

        <div class="col-md-3">
          <div class="form-group">
            <label for="studentNumber">City</label>
            <input id="reg-permanent-city" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>

        <div class="col-md-3">
          <div class="form-group">
            <label for="studentNumber">Province</label>
            <input id="reg-permanent-province" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>
      </div>

      <!-- new row -->
      <div class="row">
        <div class="col-md-6">
          <div class="form-group">
            <label for="studentNumber">Phone</label>
            <input id="reg-permanent-phone" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>

        <div class="col-md-3">
          <div class="form-group">
            <label for="studentNumber">Postal Code</label>
            <input id="reg-permanent-postal" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>

        <div class="col-md-3">
          <div class="form-group">
            <label for="studentNumber">Country</label>
            <input id="reg-permanent-country" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>
      </div>

      <!-- new row -->
      <div class="row">
        <div class="col-md-12">
         <div class="form-group">
            <label for="studentNumber">Home Town</label>
            <input id="reg-hometown" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">Athlete History</div>
    <div class="panel-body">

      <!-- new row -->
      <div class="row">
        <div class="col-md-6">
         <div class="form-group">
            <label for="studentNumber">U of L Team</label>
            <select class="form-control">
              <option>team ajax</option>
            </select>
          </div>
        </div>

        <div class="col-md-6">
          <div class="form-group">
            <label for="studentNumber">Other Team</label>
            <input id="reg-team-name" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>
      </div>

      <!-- new row -->
      <div class="row">
        <div class="col-md-5">
         <div class="form-group">
            <label for="studentNumber">Position</label>
            <input id="reg-team-position" type="input" class="form-control" id="studentNumber" placeholder=""YYYY-YYYY"">
          </div>
        </div>

        <div class="col-md-2">
         <div class="form-group">
            <label for="studentNumber">Year</label>
            <input id="reg-team-year" type="input" class="form-control" id="studentNumber" placeholder="YYYY-YYYY">
          </div>
        </div>

        <div class="col-md-2">
          <div class="form-group">
            <label for="studentNumber">Jersey #</label>
            <input id="reg-team-jersey" type="input" class="form-control" id="studentNumber" placeholder="">
          </div>
        </div>

        <div class="col-md-2">
          <div class="form-group">
            <label for="studentNumber">Charged</label>
            <select id="reg-team-charged" class="form-control">
              <option>yes</option>
              <option>no</option>
            </select>
          </div>
        </div>

        <div class="col-md-1">
          <div class="form-group">
            <label for="studentNumber">&nbsp</label>
            <button id="team-add-button" type="button" class="btn btn-primary">Add</button>
          </div>
        </div>
      </div>

      <table id="team-table" class="table table-condensed"></table>

      <!-- suspensions text area 
      <textarea id="reg-suspensions" class="form-control" rows="3" placeholder="Please indicate if you are presently under suspension from any sport organization or league."></textarea>
      -->
    </div>
  </div>

  <div class="well">
    * The information collected in this form is used and disclosed by Canadian Interuniversity Sport("CIS") in accordance with the terms of CIS' Student Athlete Acknowledgement Form and CIS' Personal Information Protection Policy.<br />
    For further information about CIS' collection, use and disclosure of personal information, see our Personal Information Protection Policy at <a href="http://www.cis-sic.ca">www.cis-sic.ca</a>.
  </div>

  <!-- new row -->
  <div class='row'>
    <div class="col-md-10"></div>
    <div class="col-md-2">
      <button id="register-button" type="button" class="btn btn-lg btn-primary btn-block">Register</button>
    </div>
  </div>

</form>

<script>

  var teamHistory = new Array();

  function init() {
    addEventListeners();
  }

  //Button Listeners
  function addEventListeners() {
    $("#team-add-button").click(addTeamClick);
    $("#register-button").click(registerClick);
  }

  // == team history ==

  function addTeamClick(event) {
    // validate input
    var years = $( "#reg-team-year" ).val().split("-"),
        startYear = years[0],
        endYear = years[1],
        teamId = 0,
        teamName = $( "#reg-team-name" ).val(),
        position = $( "#reg-team-position" ).val(),
        jersey = $( "#reg-team-jersey" ).val(),
        charged = $( "#reg-team-charged" ).val();

    // store in temp array
    teamHistory.push({
      startYear : startYear,
      endYear   : endYear,
      teamId    : teamId,
      teamName  : teamName,
      position  : position,
      jersey    : jersey,
      charged   : charged
    });

    // redraw the table
    redrawTable();
  }

  function redrawTable() {
    var tableString = "<thead><tr><td>Year</td><td>Team</td><td>Position</td><td>Jersey</td><td>Charged</td><td> </td></tr></thead><tbody>";
    for (var i = 0; i < teamHistory.length; i++) {
      tableString += "<tr>";
      tableString += "<td>" + teamHistory[i].startYear + "-" + teamHistory[i].endYear + "</td>";

      if (teamHistory[i].teamId != 0)
        tableString += "<td>put uofl team name here</td>";
      else
        tableString += "<td>" + teamHistory[i].teamName + "</td>";

      tableString += "<td>" + teamHistory[i].position + "</td>";
      tableString += "<td>" + teamHistory[i].jersey + "</td>";
      tableString += "<td>" + teamHistory[i].charged + "</td>";
      tableString += "<td><span id='team-entry-" + i + "'>remove</span></td>";
      tableString += "</tr>";
    }
    tableString += "</tbody>";
    $("#team-table").html(tableString);

    // set delete listeners
    for (var j = 0; j < teamHistory.length; j++) {
      var id = "#team-entry-" + j;
      $(id).click(removeTeamClick);
    }
  }

  function removeTeamClick( event ) {
    // remove delete listeners
    for (var j = 0; j < teamHistory.length; j++) {
      var id = "#team-entry-" + j;
      $(id).unbind();
    }

    // remove array entry
    var index = event.target.id.substr(11);
    teamHistory.splice(index, 1);

    // redraw
    redrawTable();
  }

  // == register button ==

  function registerClick() {
    var studentNum = $("#reg-student-number").val(),
        email = $("#reg-email").val(),
        firstName = $("#reg-first-name").val(),
        lastName = $("#reg-last-name").val(),
        initials = $("#reg-initials").val(),
        gender = $("#reg-gender").val(),
        dob = $("#reg-date-of-birth").val(),
        height = $("#reg-height").val(),
        weight = $("#reg-weight").val(),
        hometown = $("#reg-hometown").val(),
        suspensions = $("#reg-suspensions").val(),

        cStreet = $("#reg-current-street").val(),
        cCity = $("#reg-current-city").val(),
        cProvince = $("#reg-current-province").val(),
        cPostal = $("#reg-current-postal").val(),
        cCountry = $("#reg-current-country").val(),
        cPhone = $("#reg-current-phone").val(),

        pStreet = $("#reg-permanent-street").val(),
        pCity = $("#reg-permanent-city").val(),
        pProvince = $("#reg-permanent-province").val(),
        pPostal = $("#reg-permanent-postal").val(),
        pCountry = $("#reg-permanent-country").val(),
        pPhone = $("#reg-permanent-phone").val();

    // send registration data to the server via ajax
    $.ajax({
      type     : 'POST',
      url      : 'php/registermanager.php',
      dataType : 'json',
      data     : { 
        studentNum : studentNum,
        email      : email,
        firstName  : firstName,
        lastName   : lastName,
        initials   : initials,
        gender     : gender,
        dob        : dob,
        height     : height,
        weight     : weight,
        hometown   : hometown,
        suspension : suspensions,

        cStreet    : cStreet,
        cCity      : cCity,
        cProvince  : cProvince,
        cPostal    : cPostal,
        cCountry   : cCountry,
        cPhone     : cPhone,

        pStreet    : pStreet,
        pCity      : pCity,
        pProvince  : pProvince,
        pPostal    : pPostal,
        pCountry   : pCountry,
        pPhone     : pPhone,

        teamHist   : teamHistory
      },
      cache    : false,
      success  : function( result ) {
        console.log(result);
      },
      error    : function(a, b, c) {
        console.log('Error:');
        console.log(a);
        console.log(b);
        console.log(c);
      }
    });
  }

  init();

</script>

